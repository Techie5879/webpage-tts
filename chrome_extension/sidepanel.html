<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Webpage TTS Sidebar</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body class="sidebar">
    <div class="app">
      <header class="header">
        <div class="header-row">
          <div>
            <div class="title">Webpage TTS</div>
            <div class="subtitle">Pinned controls for speaking any page.</div>
          </div>
          <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle theme">
            <span class="theme-icon">☀︎</span>
            <span class="theme-text">Light</span>
          </button>
        </div>
      </header>
      <div class="content">
        <section class="card">
          <div class="section-head">
            <div class="section-title">Session</div>
            <div class="section-sub">Source + playback</div>
          </div>
          <label class="label" for="serverUrl">Server URL</label>
          <input id="serverUrl" class="input" type="text" placeholder="http://127.0.0.1:9872" />

          <div class="session-grid">
            <div>
              <label class="label" for="source">Text source</label>
              <div class="select-wrap">
                <select id="source" class="select">
                  <option value="selection">Selection (fallback to page)</option>
                  <option value="page">Whole page</option>
                </select>
              </div>
            </div>
            <div>
              <label class="label" for="playbackTarget">Playback</label>
              <div class="select-wrap">
                <select id="playbackTarget" class="select">
                  <option value="offscreen">Offscreen (recommended)</option>
                  <option value="popup">Panel only</option>
                </select>
              </div>
            </div>
            <div>
              <label class="label" for="chunkSize">Chunk size</label>
              <input id="chunkSize" class="input" type="number" min="200" max="1200" step="20" />
            </div>
            <div class="span-3">
              <label id="customModelSizeLabel" class="label">Model size</label>
              <div
                id="customModelSize"
                class="option-group"
                role="radiogroup"
                aria-labelledby="customModelSizeLabel"
              >
                <label class="option-chip">
                  <input type="radio" name="customModelSize" value="0.6b" />
                  <span>0.6B Fast</span>
                </label>
                <label class="option-chip">
                  <input type="radio" name="customModelSize" value="1.7b" />
                  <span>1.7B Quality</span>
                </label>
              </div>
            </div>
          </div>

          <div class="speaker-block">
            <label class="label">Speaker</label>
            <div id="speakerButtons" class="speaker-grid"></div>
          </div>
        </section>

        <section class="card">
          <div class="section-head">
            <div class="section-title">Voice</div>
            <div class="section-sub">Mode + styling</div>
          </div>
          <div class="mode-grid">
            <button class="mode-btn" data-mode="custom">Custom Voices</button>
            <button class="mode-btn" data-mode="design">Voice Design</button>
            <button class="mode-btn" data-mode="clone">Voice Clone</button>
          </div>

          <div id="mode-custom" class="mode-panel">
            <label class="label" for="instruction">Optional style instruction</label>
            <textarea id="instruction" class="textarea" rows="2" placeholder="calm, warm, podcast style"></textarea>
          </div>

          <div id="mode-design" class="mode-panel">
            <label class="label" for="designPrompt">Voice description</label>
            <textarea id="designPrompt" class="textarea" rows="3" placeholder="A confident British narrator with a smooth, warm tone"></textarea>
            <div class="row">
              <div class="col">
                <label class="label" for="designName">Save as</label>
                <input id="designName" class="input" type="text" placeholder="My narrator" />
              </div>
              <div class="col actions-row">
                <button id="saveDesign" class="ghost">Save voice</button>
              </div>
            </div>
          </div>

          <div id="mode-clone" class="mode-panel">
            <label class="label" for="cloneAudio">Reference audio (wav/mp3)</label>
            <input id="cloneAudio" class="input" type="file" accept="audio/*" />

            <label class="label" for="cloneText">Reference text</label>
            <textarea id="cloneText" class="textarea" rows="2" placeholder="The exact words spoken in the reference audio"></textarea>

            <div class="row">
              <div class="col">
                <label class="label" for="cloneName">Save as</label>
                <input id="cloneName" class="input" type="text" placeholder="My cloned voice" />
              </div>
              <div class="col actions-row">
                <button id="saveClone" class="ghost">Save voice</button>
              </div>
            </div>
          </div>
        </section>

        <section class="card">
          <div class="section-head">
            <div class="section-title">Saved</div>
            <div class="section-sub">Reusable voices</div>
          </div>
          <div class="row">
            <div class="col">
              <label class="label" for="savedVoices">Saved voices</label>
              <div class="select-wrap">
                <select id="savedVoices" class="select"></select>
              </div>
            </div>
            <div class="col actions-row">
              <button id="applyVoice" class="ghost">Apply</button>
              <button id="removeVoice" class="ghost danger">Remove</button>
            </div>
          </div>
        </section>
      </div>

      <section class="card footer">
        <div class="section-head">
          <div class="section-title">Playback</div>
          <div class="section-sub">Live controls</div>
        </div>
        <div class="actions actions-main">
          <button id="speak" class="primary">Speak</button>
          <button id="testTone" class="ghost">Test Tone</button>
          <button id="testTts" class="ghost">Test TTS (MLX)</button>
        </div>
        <div class="actions actions-sub">
          <button id="pause" class="ghost">Pause</button>
          <button id="resume" class="ghost">Resume</button>
          <button id="stop" class="ghost danger">Stop</button>
        </div>
        <div id="status" class="status">Idle.</div>
      </section>
    </div>
    <script src="popup.js"></script>
  </body>
</html>
